{% extends 'base.jinja2' %}
{% from 'macros/generate_filter_criteria_dropdowns.jinja2' import  generate_filter_criteria_dropdowns %}
{% from 'macros/update_selected_location_dropdowns.jinja2' import update_selected_location_dropdowns %}
{% block title %}{% trans %} County Impact Indicators {% endtrans %}{% endblock %}

{% block page_title %}
  <h3 class="page-title">
    {{ self.title() }}
    <small></small>
  </h3>
{% endblock %}

{% block breadcrumbs %}
  <li>{{ self.title() }}</li>
  <li><a href="#"> </a></li>
{% endblock %}

{% block content %}
  {{ generate_filter_criteria_dropdowns(request, filter_criteria, search_criteria) }}

  <div class="row">
    <div class="col-md-12">
      <!-- BEGIN SAMPLE TABLE PORTLET-->
      <div class="portlet">
        <div class="portlet-title">
          <div class="caption">
            <i class="icon-tasks"></i>
            {% if location %}
              {{ location.pretty }} {{ location.location_type | humanize() | title()}}
            {% else %}
              {% trans %}All Counties{% endtrans %}
            {% endif %}
          </div>
        </div>
        <div class="portlet-body">
          <div class="table-responsive">
            <table class="table table-striped table-bordered table-hover">
              <thead>
              <tr>
              {% if target_class %}
                <th>{{target_class.__name__}}</th>
              {% else %}
                <th>{% trans %}County{% endtrans %}</th>
              {% endif %}
                {% for indicator in indicators %}
                  <th>{{ indicator.label }}</th>
                {% endfor %}
              </tr>
              </thead>

              <tbody>
              {% for row in rows %}
                <tr>
                  <td>
                    <a href="{{request.route_path('impact_indicators', traverse=(row.location.id))}}">{{ row.location.pretty }}</a>
                  </td>
                  {% for indicator in indicators %}
                    <td>{{ row.indicators[indicator.key] }}</td>
                  {% endfor %}
                </tr>
              {% endfor %}

              <tr class="bold">
                <td>
                  {% trans %} Total Summary {% endtrans %}
                </td>
                {% for indicator in indicators %}
                  <td>{{ summary_row[indicator.key] }}</td>
                {% endfor %}
              </tr>

              </tbody>
            </table>
          </div>
        </div>
      </div>
      <!-- END SAMPLE TABLE PORTLET-->
    </div>
  </div>
{% endblock %}
{% block page_scripts %}
    <script src="{{ request.static_url('wkcdd:static/scripts/custom.js') }}"></script>
{% endblock %}
{% block jquery_ready %}
  {{ super() }}

  location_json_data = {{ filter_criteria["location_json_data"]|safe() }};
  LocationSelect.data_map = location_json_data;

  {{ update_selected_location_dropdowns(search_criteria) }}
{% endblock %}